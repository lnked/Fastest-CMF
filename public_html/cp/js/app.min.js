var app = app || {};

(function(body){
    "use strict";

    app = {
        
        init: function()
        {
            this.history.init();
            
            // var container = document.querySelector('.gallery');

            // container.addEventListener('click', function(e) {
            //   if (e.target != e.currentTarget) {
            //     e.preventDefault();
            //     // e.target is the image inside the link we just clicked.
            //   }
            //   e.stopPropagation();
            // }, false);

            // window.addEventListener('popstate', function(e) {
            //   // e.state is equal to the data-attribute of the last image we clicked
            // });
        }

    };

})(document.body);

// cookie.set({
//    key1: 'value1',
//    key2: 'value2'
// });

// cookie.set('key', 'value', {
//    expires: 7, // expires in one week
// });

// cookie.set({
//    key1: 'value1',
//    key2: 'value2'
// }, {
//    expires: 7
// })

// cookie.defaults.expires = 7;
// cookie.defaults.secure = true;


// cookie.expiresMultiplier = 60; // Seconds.
// cookie.expiresMultiplier = 60 * 60; // Minutes.
// cookie.expiresMultiplier = 60 * 60 * 24; // Hours.


// cookie.get('key');

// cookie.get(['key1', 'key2']);

// cookie.get('key', 'default value');
// cookie.get(['key1', 'key2'], 'default value');


// cookie.get('key');
// // is the same as
// cookie('key');

// var cookies = cookie.all();

// cookie.remove('key');
// cookie.remove('key1', 'key2');
// cookie.remove(['key1', 'key2']);

// if (cookie.enabled()) {
//    // Do stuff with cookies
// } else {
//    // Display error message or use localStorage
// }


// cookie.set('a', '1');
// cookie.setDefault({
//    a: '2',
//    b: '2'
// });

// cookie.get(['a', 'b']); // {a: "1", b: "2"}

// cookie.set('a', 'b', { path: '/somepath' });

// // This won't work
// cookie.remove('a');

// // You have to do this
// cookie.removeSpecific('a', { path: '/somepath' });

// // You can also give an array of cookie keys
// cookie.removeSpecific(['a', 'b'], { path: '/somepath' });

// cookie.empty().set('key1', 'value1').set('key2', 'value2').remove('key1');

// cookie.utils.decode = function (value) {
//    return decodeURIComponent(value).replace('+', ' ');
// };

var app = app || {};

(function(body){
    "use strict";

    // // Prepare
    // var History = window.History; // Note: We are using a capital H instead of a lower h
    // if ( !History.enabled ) {
    //      // History.js is disabled for this browser.
    //      // This is because we can optionally choose to support HTML4 browsers or not.
    //     return false;
    // }

    // // Bind to StateChange Event
    // History.Adapter.bind(window,'statechange',function() { // Note: We are using statechange instead of popstate
    //     var State = History.getState();
    //     $('#content').load(State.url);
    //     /* Instead of the line above, you could run the code below if the url returns the whole page instead of just the content (assuming it has a `#content`): */
    //     $.get(State.url, function(response) {
    //         $('#content').html($(response).find('#content').html()); });
    //     });


    // // Capture all the links to push their url to the history stack and trigger the StateChange Event
    // $('a').click(function(evt) {
    //     evt.preventDefault();
    //     History.pushState(null, $(this).text(), $(this).attr('href'));
    // });

    app.history = {
        
        init: function()
        {
            // function requestContent(file) {
            //   $('.wrapper__content').load(file + ' .wrapper__content');
            // }

            // window.addEventListener('popstate', function(e) {
            //   var character = e.state;

            //   if (character == null) {
            //     removeCurrentClass();
            //     textWrapper.innerHTML = " ";
            //     content.innerHTML = " ";
            //     document.title = defaultTitle;
            //   } else {
            //       updateText(character);
            //       requestContent(character + ".html");
            //       addCurrentClass(character);
            //       document.title = "Ghostbuster | " + character;
            //   }
            // });

            console.log(window.History);

            window.history.pushState({}, null, '/cp/site/edik');

            // Bind to StateChange Event
            // History.Adapter.bind(window,'statechange',function(){ // Note: We are using statechange instead of popstate
            //     var State = History.getState(); // Note: We are using History.getState() instead of event.state
            // });

            // // // Change our States
            // History.pushState({state:1}, "State 1", "?state=1"); // logs {state:1}, "State 1", "?state=1"
            // History.pushState({state:2}, "State 2", "?state=2"); // logs {state:2}, "State 2", "?state=2"
            // History.replaceState({state:3}, "State 3", "?state=3"); // logs {state:3}, "State 3", "?state=3"
            // History.pushState(null, null, "?state=4"); // logs {}, '', "?state=4"
            // History.back(); // logs {state:3}, "State 3", "?state=3"
            // History.back(); // logs {state:1}, "State 1", "?state=1"
            // History.back(); // logs {}, "Home Page", "?"
            // History.go(2); // logs {state:3}, "State 3", "?state=3"
            
            /*  Инициализируем контейнер для записей */
            var $entries = $(".wrapper__content");

            /* Вешаем обработчики onlick на ссылки */
            var $page_links = $(".nav"),
                $prev_link = $page_links.find("a.nav__item__link"),
                $next_link = $page_links.find("a.nav__item__link");
            $page_links.delegate("a", "click", function (e) {
                e.preventDefault();
                var url = $(this).attr("href");

                /*  Удаляем текущие записи из контейнера */
                $entries.empty();

                /*  Показываем индикатор загрузки */
                $entries.addClass("loading");

                /*  И сообщаем History.js об изменении состояния страницы
                В качестве первого агрумента можно передать произвольный объект
                с дополнительными данными, которые можно извлечь в обработчике
                изменения состояния, описанном ниже.
                В нашем случае это будет пустой объект. */
                window.history.pushState({}, null, url);
            });

            /*  Готовим обработчик изменения состояния страницы */
            window.history.Adapter.bind(window, "statechange", function () {
                /*  Получаем информацию о состоянии страницы */
                var state = window.history.getState();

                /* Получаем URL нового состояния. Это URL, который мы передали
                в .pushState() */
                var url = state.url;

                /*  Тут можно извлечь дополнительные данные, о которых шла речь выше.
                Например, так: var data = state.data; */

                /*  Отправляем AJAX-запрос на сервер.
                В качестве ответа мы ожидаем JSON-объект следующего формата:
                {entries: "<article><h1>...</h1>...</article> <article>...",
                 title: "Страница 3",
                 next_url: "/blog/page/4",
                 prev_url: "/blog/page/2" }
                Каким образом будет сформирован этот ответ, зависит только от вас. */
                $.getJSON(url, function (response) {

                    /*  Обновляем заголовок страницы */
                    $("title").text(response.title);

                    /*  Обновляем ссылки на предыдущую и следующую страницы */
                    $prev_link.attr("href", response.prev_url);
                    $next_link.attr("href", response.next_url);

                    /*  И, наконец, показываем новый блок записей */
                    $entries.removeClass("loading").html(response.entries);
                });
            });
        }

    };

})(document.body);

// (function(window,undefined){

//     // Check Location
//     if ( document.location.protocol === 'file:' ) {
//         alert('The HTML5 History API (and thus History.js) do not work on files, please upload it to a server.');
//     }

//     // Establish Variables
//     var
//         History = window.History, // Note: We are using a capital H instead of a lower h
//         State = History.getState(),
//         $log = $('#log');

//     // Log Initial State
//     History.log('initial:', State.data, State.title, State.url);

//     // Bind to State Change
//     History.Adapter.bind(window,'statechange',function(){ // Note: We are using statechange instead of popstate
//         // Log the State
//         var State = History.getState(); // Note: We are using History.getState() instead of event.state
//         History.log('statechange:', State.data, State.title, State.url);
//     });

//     // Prepare Buttons
//     var
//         buttons = document.getElementById('buttons'),
//         scripts = [
//             'History.pushState({state:1,rand:Math.random()}, "State 1", "?state=1"); // logs {state:1,rand:"some random value"}, "State 1", "?state=1"',
//             'History.pushState({state:2,rand:Math.random()}, "State 2", "?state=2"); // logs {state:2,rand:"some random value"}, "State 2", "?state=2"',
//             'History.replaceState({state:3,rand:Math.random()}, "State 3", "?state=3"); // logs {state:3,rand:"some random value"}, "State 3", "?state=3"',
//             'History.pushState(null, null, "?state=4"); // logs {}, "", "?state=4"',
//             'History.back(); // logs {state:3}, "State 3", "?state=3"',
//             'History.back(); // logs {state:1}, "State 1", "?state=1"',
//             'History.back(); // logs {}, "The page you started at", "?"',
//             'History.go(2); // logs {state:3}, "State 3", "?state=3"'
//         ],
//         buttonsHTML = ''
//         ;

//     // Add Buttons
//     for ( var i=0,n=scripts.length; i<n; ++i ) {
//         var _script = scripts[i];
//         buttonsHTML +=
//             '<li><button onclick=\'javascript:'+_script+'\'>'+_script+'</button></li>';
//     }
//     buttons.innerHTML = buttonsHTML;

// })(window);
var app = app || {};

(function(body){
    "use strict";

    app.preload = {

        preload: function($image)
        {
            var url = $image.data('preload'), image = null;

            try {
                image = new Image();
                image.onload = function() {
                    $image.attr('src', url);
                };
                image.src = url;
            }
            catch (e) {
                $image.attr('src', url);
            }
            
            $image.removeAttr('width height');
            $image.data('preload', '');
        },

        init: function()
        {
            if ($('img[data-preload]').length)
            {
                var _this = this;
            
                $('img[data-preload]').each(function(){
                    (function($image){
                        _this.preload($image);
                    })($(this))
                });
            }
        }

    };

})(document.body);
var app = app || {};

(function(body){
    "use strict";

    app.quantity = {

        config: {
            element: '.j-quantity',
            input: '.j-quantity-count',
            control: '.j-quantity-control',
            complete: null
        },

        element: null,

        extend: function(config)
        {
            var _this = this;

            if (typeof config !== 'undefined')
            {
                var x;
                for (x in config)
                {
                    if (typeof _this.config[x] !== 'undefined')
                        _this.config[x] = config[x];
                }
            }
        },

        setValue: function(quantity)
        {
            var min = 1, max = 100;

            if (this.element.data('min')) {
                min = this.element.data('min');   
            }
            
            if (this.element.data('max')) {
                max = this.element.data('max');   
            }

            if (quantity > max) {
                quantity = max;
            }
            
            if (quantity < min) {
                quantity = min;
            }

            this.element.find(this.config.input).val(quantity);

        },

        increase: function(quantity)
        {
            quantity += 1;

            this.setValue(quantity);
        },

        decrease: function(quantity)
        {
            if (quantity > 1) {
                quantity -= 1;
            }

            this.setValue(quantity);
        },

        callback: function()
        {
            if (typeof(this.element.data('product')) !== 'undefined' && typeof(this.config.complete) == 'function')
            {
                this.config.complete.call(null, this.element, this.element.data('product'));
            }
        },

        keys: function()
        {
            var _this = this, role = '';

            $('body').on('keydown', _this.config.input, function(e) {
                if ([38, 40].indexOf(e.keyCode) >= 0)
                {
                    e.preventDefault();

                    role = {
                        38: 'increase',
                        40: 'decrease'
                    };

                    _this.element = $(this).closest(_this.config.element);

                    _this[role[e.keyCode]](parseInt(_this.element.find(_this.config.input).val()));

                    _this.callback();

                    return false;
                }
            });
        },

        bind: function()
        {
            var _this = this, role = '';

            $('body').on('click', _this.config.control, function(e) {
                e.preventDefault();

                _this.element = $(this).closest(_this.config.element);

                role = $(this).data('role');
         
                if(['increase', 'decrease'].indexOf(role) >= 0)
                {
                    _this[role](parseInt(_this.element.find(_this.config.input).val()));
                }

                _this.callback();

                return !1;
            });
        },

        init: function(config)
        {
            if (typeof config !== 'undefined')
            {
                this.extend(config);
            }

            this.bind();
            this.keys();
        }

    };

})(document.body);

// this.quantity.init({
//     complete: function(element, id) {
//         // $(element).css({
//         //     'border': '1px solid lime'
//         // });

//         console.log("id :", id);
//     }
// });

// <div class="quantity j-quantity clearfix" data-product="1000" data-min="1" data-max="999">
//     <button type="button" class="quantity__control _decrease j-quantity-control" data-role="decrease"></button>
//     <input type="text" name="count[1000]" value="1" data-role="quantity-input" class="quantity__count j-quantity-count" maxlength="3" autocomplete="off">
//     <button type="button" class="quantity__control _increase j-quantity-control" data-role="increase"></button>
// </div>
var app = app || {};

;(function(body){
    "use strict";

    var _this;

    app.sandwich = {

        config: {
            keyHooks: !1,
            selector: '.js-sandwich-menu',
            wrapper: '.layout-wrapper',
            overlay: '.overlay'
        },

        extend: function(config)
        {
            _this = this;

            if (typeof config !== 'undefined')
            {
                var x;
                for (x in config)
                {
                    if (typeof _this.config[x] !== 'undefined')
                        _this.config[x] = config[x];
                }
            }
        },

        isOpen: function()
        {
            return $('body').hasClass('page-visible');
        },

        hide: function()
        {
            $('body').removeClass('page-open');

            setTimeout(function(){
                $('body').removeClass('page-visible');
            }, 10);

            $(this.config.overlay).css({
                'visibility': 'hidden'
            });
        },

        toggle: function()
        {
            if ($('body').hasClass('page-visible'))
            {
                $('body').removeClass('page-open');

                setTimeout(function(){
                    $('body').removeClass('page-visible');
                }, 200);
            }
            else
            {
                $('body').addClass('page-open');

                setTimeout(function(){
                    $('body').addClass('page-visible');
                }, 10);
            }

            var visibility = 'visible';

            if (!$('body').hasClass('page-open'))
            {
                visibility = 'hidden'
            }
            
            $(_this.config.overlay).css({
                'visibility': visibility
            });
        },

        sandwichTrigger: function()
        {
            _this = this;

            if (_this.config.keyHooks)
            {
                $('body').on('keydown', function(e) {
                    if(e.keyCode == 27 && _this.isOpen())
                    {
                        _this.toggle();
                    }
                });
            };

            $('body').on('click', _this.config.selector, function(e){
                e.preventDefault ? e.preventDefault() : e.returnValue = false;
                _this.toggle();
            });
        },

        overlayTrigger: function()
        {
            _this = this;

            $('body').on('click', _this.config.overlay, function(e){
                _this.hide();
            });
        },

        init: function(config)
        {
            this.extend(config);
            this.sandwichTrigger();
            this.overlayTrigger();
        }

    };

})(document.body);
var app = app || {};

(function(body){
    "use strict";

    app.tabs = {

        init: function() {
            var $wrapper = null, tab = '';

            $('body').on('click', '.j-tab-trigger', function(e){
                e.preventDefault();

                if (!$(this).hasClass('_open')) {
                    tab = $(this).data('tab');

                    $wrapper = $(this).closest('.j-tab-wrapper');

                    $wrapper.find('.j-tab-trigger').removeClass('_current');
                    $wrapper.find('.j-tab-item').removeClass('_open');

                    $wrapper.find('#tab-'+tab).addClass('_open');
                    $(this).addClass('_current');
                }

                return !1;
            });
        }

    };

})(document.body);
var app = app || {};

(function(body){
    "use strict";

    app.toggle = {
        
        init: function() {
            
            var $toggle = null, text = '', hide = true, remove = false;

            $('body').on('click', '.j-toggle-trigger', function(e){
                e.preventDefault();

                $toggle = $(this).closest('.j-toggle').find('.j-toggle-item');

                if ($toggle)
                {
                    $toggle.toggleClass('is-show');
                }

                if ($toggle.hasClass('is-hidden'))
                {
                    $toggle.removeClass('is-hidden');
                }

                if ($(this).data('toggle-text')) {
                    text = $(this).data('toggle-text');
                }

                if (typeof($(this).data('remove')) !== 'undefined') {
                    remove = $(this).data('remove') == '0' ? false : ($(this).data('remove') == '1' ? true : false);
                }
                
                if (hide) {
                    $(this).hide();
                }
                
                if (remove) {
                    $(this).remove();
                }

                if (text) {
                    $(this).data('toggle-text', $(this).html());
                    $(this).html(text);
                }

                return false;
            })

        }

    };

})(document.body);

// <div class="j-toggle">
//     <div class="j-toggle-item"> content </div>
//     <span class="j-toggle-trigger" data-toggle-text="Скрыть..." data-hide="1" data-remove="1">Еще...</span>
// </div>
"use strict";

function __() {try {for(var i=0; i<arguments.length; i++) {console.log(arguments[i]);}}catch (e) {}}

function sprintf(v) {
  var split = v.toString().split('.'), pad = "00", time = [], x = null;

  for (x in split) {
    time.push(pad.substring(0, 2 - split[x].toString().length) + split[x]);
  }

  return time.join('.');
}
$(document).ready(function() {
    app.init();
});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIl9fYXBwLmpzIiwiX2FwcC5oaXN0b3J5LmpzIiwiX2FwcC5wcmVsb2FkLmpzIiwiX2FwcC5xdWFudGl0eS5qcyIsIl9hcHAuc2FuZHdpY2guanMiLCJfYXBwLnRhYnMuanMiLCJfYXBwLnRvZ2dsZS5qcyIsIl9mdW5jdGlvbnMuanMiLCJpbml0LmpzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQ3hHQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0TEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMxQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FDM0pBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUN0SEE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQy9CQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUMzREE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUNaQTtBQUNBO0FBQ0EiLCJmaWxlIjoiYXBwLm1pbi5qcyIsInNvdXJjZXNDb250ZW50IjpbInZhciBhcHAgPSBhcHAgfHwge307XG5cbihmdW5jdGlvbihib2R5KXtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFwcCA9IHtcbiAgICAgICAgXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdGhpcy5oaXN0b3J5LmluaXQoKTtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgLy8gdmFyIGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5nYWxsZXJ5Jyk7XG5cbiAgICAgICAgICAgIC8vIGNvbnRhaW5lci5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgIC8vICAgaWYgKGUudGFyZ2V0ICE9IGUuY3VycmVudFRhcmdldCkge1xuICAgICAgICAgICAgLy8gICAgIGUucHJldmVudERlZmF1bHQoKTtcbiAgICAgICAgICAgIC8vICAgICAvLyBlLnRhcmdldCBpcyB0aGUgaW1hZ2UgaW5zaWRlIHRoZSBsaW5rIHdlIGp1c3QgY2xpY2tlZC5cbiAgICAgICAgICAgIC8vICAgfVxuICAgICAgICAgICAgLy8gICBlLnN0b3BQcm9wYWdhdGlvbigpO1xuICAgICAgICAgICAgLy8gfSwgZmFsc2UpO1xuXG4gICAgICAgICAgICAvLyB3aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcigncG9wc3RhdGUnLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAvLyAgIC8vIGUuc3RhdGUgaXMgZXF1YWwgdG8gdGhlIGRhdGEtYXR0cmlidXRlIG9mIHRoZSBsYXN0IGltYWdlIHdlIGNsaWNrZWRcbiAgICAgICAgICAgIC8vIH0pO1xuICAgICAgICB9XG5cbiAgICB9O1xuXG59KShkb2N1bWVudC5ib2R5KTtcblxuLy8gY29va2llLnNldCh7XG4vLyAgICBrZXkxOiAndmFsdWUxJyxcbi8vICAgIGtleTI6ICd2YWx1ZTInXG4vLyB9KTtcblxuLy8gY29va2llLnNldCgna2V5JywgJ3ZhbHVlJywge1xuLy8gICAgZXhwaXJlczogNywgLy8gZXhwaXJlcyBpbiBvbmUgd2Vla1xuLy8gfSk7XG5cbi8vIGNvb2tpZS5zZXQoe1xuLy8gICAga2V5MTogJ3ZhbHVlMScsXG4vLyAgICBrZXkyOiAndmFsdWUyJ1xuLy8gfSwge1xuLy8gICAgZXhwaXJlczogN1xuLy8gfSlcblxuLy8gY29va2llLmRlZmF1bHRzLmV4cGlyZXMgPSA3O1xuLy8gY29va2llLmRlZmF1bHRzLnNlY3VyZSA9IHRydWU7XG5cblxuLy8gY29va2llLmV4cGlyZXNNdWx0aXBsaWVyID0gNjA7IC8vIFNlY29uZHMuXG4vLyBjb29raWUuZXhwaXJlc011bHRpcGxpZXIgPSA2MCAqIDYwOyAvLyBNaW51dGVzLlxuLy8gY29va2llLmV4cGlyZXNNdWx0aXBsaWVyID0gNjAgKiA2MCAqIDI0OyAvLyBIb3Vycy5cblxuXG4vLyBjb29raWUuZ2V0KCdrZXknKTtcblxuLy8gY29va2llLmdldChbJ2tleTEnLCAna2V5MiddKTtcblxuLy8gY29va2llLmdldCgna2V5JywgJ2RlZmF1bHQgdmFsdWUnKTtcbi8vIGNvb2tpZS5nZXQoWydrZXkxJywgJ2tleTInXSwgJ2RlZmF1bHQgdmFsdWUnKTtcblxuXG4vLyBjb29raWUuZ2V0KCdrZXknKTtcbi8vIC8vIGlzIHRoZSBzYW1lIGFzXG4vLyBjb29raWUoJ2tleScpO1xuXG4vLyB2YXIgY29va2llcyA9IGNvb2tpZS5hbGwoKTtcblxuLy8gY29va2llLnJlbW92ZSgna2V5Jyk7XG4vLyBjb29raWUucmVtb3ZlKCdrZXkxJywgJ2tleTInKTtcbi8vIGNvb2tpZS5yZW1vdmUoWydrZXkxJywgJ2tleTInXSk7XG5cbi8vIGlmIChjb29raWUuZW5hYmxlZCgpKSB7XG4vLyAgICAvLyBEbyBzdHVmZiB3aXRoIGNvb2tpZXNcbi8vIH0gZWxzZSB7XG4vLyAgICAvLyBEaXNwbGF5IGVycm9yIG1lc3NhZ2Ugb3IgdXNlIGxvY2FsU3RvcmFnZVxuLy8gfVxuXG5cbi8vIGNvb2tpZS5zZXQoJ2EnLCAnMScpO1xuLy8gY29va2llLnNldERlZmF1bHQoe1xuLy8gICAgYTogJzInLFxuLy8gICAgYjogJzInXG4vLyB9KTtcblxuLy8gY29va2llLmdldChbJ2EnLCAnYiddKTsgLy8ge2E6IFwiMVwiLCBiOiBcIjJcIn1cblxuLy8gY29va2llLnNldCgnYScsICdiJywgeyBwYXRoOiAnL3NvbWVwYXRoJyB9KTtcblxuLy8gLy8gVGhpcyB3b24ndCB3b3JrXG4vLyBjb29raWUucmVtb3ZlKCdhJyk7XG5cbi8vIC8vIFlvdSBoYXZlIHRvIGRvIHRoaXNcbi8vIGNvb2tpZS5yZW1vdmVTcGVjaWZpYygnYScsIHsgcGF0aDogJy9zb21lcGF0aCcgfSk7XG5cbi8vIC8vIFlvdSBjYW4gYWxzbyBnaXZlIGFuIGFycmF5IG9mIGNvb2tpZSBrZXlzXG4vLyBjb29raWUucmVtb3ZlU3BlY2lmaWMoWydhJywgJ2InXSwgeyBwYXRoOiAnL3NvbWVwYXRoJyB9KTtcblxuLy8gY29va2llLmVtcHR5KCkuc2V0KCdrZXkxJywgJ3ZhbHVlMScpLnNldCgna2V5MicsICd2YWx1ZTInKS5yZW1vdmUoJ2tleTEnKTtcblxuLy8gY29va2llLnV0aWxzLmRlY29kZSA9IGZ1bmN0aW9uICh2YWx1ZSkge1xuLy8gICAgcmV0dXJuIGRlY29kZVVSSUNvbXBvbmVudCh2YWx1ZSkucmVwbGFjZSgnKycsICcgJyk7XG4vLyB9O1xuIiwidmFyIGFwcCA9IGFwcCB8fCB7fTtcblxuKGZ1bmN0aW9uKGJvZHkpe1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgLy8gLy8gUHJlcGFyZVxuICAgIC8vIHZhciBIaXN0b3J5ID0gd2luZG93Lkhpc3Rvcnk7IC8vIE5vdGU6IFdlIGFyZSB1c2luZyBhIGNhcGl0YWwgSCBpbnN0ZWFkIG9mIGEgbG93ZXIgaFxuICAgIC8vIGlmICggIUhpc3RvcnkuZW5hYmxlZCApIHtcbiAgICAvLyAgICAgIC8vIEhpc3RvcnkuanMgaXMgZGlzYWJsZWQgZm9yIHRoaXMgYnJvd3Nlci5cbiAgICAvLyAgICAgIC8vIFRoaXMgaXMgYmVjYXVzZSB3ZSBjYW4gb3B0aW9uYWxseSBjaG9vc2UgdG8gc3VwcG9ydCBIVE1MNCBicm93c2VycyBvciBub3QuXG4gICAgLy8gICAgIHJldHVybiBmYWxzZTtcbiAgICAvLyB9XG5cbiAgICAvLyAvLyBCaW5kIHRvIFN0YXRlQ2hhbmdlIEV2ZW50XG4gICAgLy8gSGlzdG9yeS5BZGFwdGVyLmJpbmQod2luZG93LCdzdGF0ZWNoYW5nZScsZnVuY3Rpb24oKSB7IC8vIE5vdGU6IFdlIGFyZSB1c2luZyBzdGF0ZWNoYW5nZSBpbnN0ZWFkIG9mIHBvcHN0YXRlXG4gICAgLy8gICAgIHZhciBTdGF0ZSA9IEhpc3RvcnkuZ2V0U3RhdGUoKTtcbiAgICAvLyAgICAgJCgnI2NvbnRlbnQnKS5sb2FkKFN0YXRlLnVybCk7XG4gICAgLy8gICAgIC8qIEluc3RlYWQgb2YgdGhlIGxpbmUgYWJvdmUsIHlvdSBjb3VsZCBydW4gdGhlIGNvZGUgYmVsb3cgaWYgdGhlIHVybCByZXR1cm5zIHRoZSB3aG9sZSBwYWdlIGluc3RlYWQgb2YganVzdCB0aGUgY29udGVudCAoYXNzdW1pbmcgaXQgaGFzIGEgYCNjb250ZW50YCk6ICovXG4gICAgLy8gICAgICQuZ2V0KFN0YXRlLnVybCwgZnVuY3Rpb24ocmVzcG9uc2UpIHtcbiAgICAvLyAgICAgICAgICQoJyNjb250ZW50JykuaHRtbCgkKHJlc3BvbnNlKS5maW5kKCcjY29udGVudCcpLmh0bWwoKSk7IH0pO1xuICAgIC8vICAgICB9KTtcblxuXG4gICAgLy8gLy8gQ2FwdHVyZSBhbGwgdGhlIGxpbmtzIHRvIHB1c2ggdGhlaXIgdXJsIHRvIHRoZSBoaXN0b3J5IHN0YWNrIGFuZCB0cmlnZ2VyIHRoZSBTdGF0ZUNoYW5nZSBFdmVudFxuICAgIC8vICQoJ2EnKS5jbGljayhmdW5jdGlvbihldnQpIHtcbiAgICAvLyAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgLy8gICAgIEhpc3RvcnkucHVzaFN0YXRlKG51bGwsICQodGhpcykudGV4dCgpLCAkKHRoaXMpLmF0dHIoJ2hyZWYnKSk7XG4gICAgLy8gfSk7XG5cbiAgICBhcHAuaGlzdG9yeSA9IHtcbiAgICAgICAgXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgLy8gZnVuY3Rpb24gcmVxdWVzdENvbnRlbnQoZmlsZSkge1xuICAgICAgICAgICAgLy8gICAkKCcud3JhcHBlcl9fY29udGVudCcpLmxvYWQoZmlsZSArICcgLndyYXBwZXJfX2NvbnRlbnQnKTtcbiAgICAgICAgICAgIC8vIH1cblxuICAgICAgICAgICAgLy8gd2luZG93LmFkZEV2ZW50TGlzdGVuZXIoJ3BvcHN0YXRlJywgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgLy8gICB2YXIgY2hhcmFjdGVyID0gZS5zdGF0ZTtcblxuICAgICAgICAgICAgLy8gICBpZiAoY2hhcmFjdGVyID09IG51bGwpIHtcbiAgICAgICAgICAgIC8vICAgICByZW1vdmVDdXJyZW50Q2xhc3MoKTtcbiAgICAgICAgICAgIC8vICAgICB0ZXh0V3JhcHBlci5pbm5lckhUTUwgPSBcIiBcIjtcbiAgICAgICAgICAgIC8vICAgICBjb250ZW50LmlubmVySFRNTCA9IFwiIFwiO1xuICAgICAgICAgICAgLy8gICAgIGRvY3VtZW50LnRpdGxlID0gZGVmYXVsdFRpdGxlO1xuICAgICAgICAgICAgLy8gICB9IGVsc2Uge1xuICAgICAgICAgICAgLy8gICAgICAgdXBkYXRlVGV4dChjaGFyYWN0ZXIpO1xuICAgICAgICAgICAgLy8gICAgICAgcmVxdWVzdENvbnRlbnQoY2hhcmFjdGVyICsgXCIuaHRtbFwiKTtcbiAgICAgICAgICAgIC8vICAgICAgIGFkZEN1cnJlbnRDbGFzcyhjaGFyYWN0ZXIpO1xuICAgICAgICAgICAgLy8gICAgICAgZG9jdW1lbnQudGl0bGUgPSBcIkdob3N0YnVzdGVyIHwgXCIgKyBjaGFyYWN0ZXI7XG4gICAgICAgICAgICAvLyAgIH1cbiAgICAgICAgICAgIC8vIH0pO1xuXG4gICAgICAgICAgICBjb25zb2xlLmxvZyh3aW5kb3cuSGlzdG9yeSk7XG5cbiAgICAgICAgICAgIHdpbmRvdy5oaXN0b3J5LnB1c2hTdGF0ZSh7fSwgbnVsbCwgJy9jcC9zaXRlL2VkaWsnKTtcblxuICAgICAgICAgICAgLy8gQmluZCB0byBTdGF0ZUNoYW5nZSBFdmVudFxuICAgICAgICAgICAgLy8gSGlzdG9yeS5BZGFwdGVyLmJpbmQod2luZG93LCdzdGF0ZWNoYW5nZScsZnVuY3Rpb24oKXsgLy8gTm90ZTogV2UgYXJlIHVzaW5nIHN0YXRlY2hhbmdlIGluc3RlYWQgb2YgcG9wc3RhdGVcbiAgICAgICAgICAgIC8vICAgICB2YXIgU3RhdGUgPSBIaXN0b3J5LmdldFN0YXRlKCk7IC8vIE5vdGU6IFdlIGFyZSB1c2luZyBIaXN0b3J5LmdldFN0YXRlKCkgaW5zdGVhZCBvZiBldmVudC5zdGF0ZVxuICAgICAgICAgICAgLy8gfSk7XG5cbiAgICAgICAgICAgIC8vIC8vIC8vIENoYW5nZSBvdXIgU3RhdGVzXG4gICAgICAgICAgICAvLyBIaXN0b3J5LnB1c2hTdGF0ZSh7c3RhdGU6MX0sIFwiU3RhdGUgMVwiLCBcIj9zdGF0ZT0xXCIpOyAvLyBsb2dzIHtzdGF0ZToxfSwgXCJTdGF0ZSAxXCIsIFwiP3N0YXRlPTFcIlxuICAgICAgICAgICAgLy8gSGlzdG9yeS5wdXNoU3RhdGUoe3N0YXRlOjJ9LCBcIlN0YXRlIDJcIiwgXCI/c3RhdGU9MlwiKTsgLy8gbG9ncyB7c3RhdGU6Mn0sIFwiU3RhdGUgMlwiLCBcIj9zdGF0ZT0yXCJcbiAgICAgICAgICAgIC8vIEhpc3RvcnkucmVwbGFjZVN0YXRlKHtzdGF0ZTozfSwgXCJTdGF0ZSAzXCIsIFwiP3N0YXRlPTNcIik7IC8vIGxvZ3Mge3N0YXRlOjN9LCBcIlN0YXRlIDNcIiwgXCI/c3RhdGU9M1wiXG4gICAgICAgICAgICAvLyBIaXN0b3J5LnB1c2hTdGF0ZShudWxsLCBudWxsLCBcIj9zdGF0ZT00XCIpOyAvLyBsb2dzIHt9LCAnJywgXCI/c3RhdGU9NFwiXG4gICAgICAgICAgICAvLyBIaXN0b3J5LmJhY2soKTsgLy8gbG9ncyB7c3RhdGU6M30sIFwiU3RhdGUgM1wiLCBcIj9zdGF0ZT0zXCJcbiAgICAgICAgICAgIC8vIEhpc3RvcnkuYmFjaygpOyAvLyBsb2dzIHtzdGF0ZToxfSwgXCJTdGF0ZSAxXCIsIFwiP3N0YXRlPTFcIlxuICAgICAgICAgICAgLy8gSGlzdG9yeS5iYWNrKCk7IC8vIGxvZ3Mge30sIFwiSG9tZSBQYWdlXCIsIFwiP1wiXG4gICAgICAgICAgICAvLyBIaXN0b3J5LmdvKDIpOyAvLyBsb2dzIHtzdGF0ZTozfSwgXCJTdGF0ZSAzXCIsIFwiP3N0YXRlPTNcIlxuICAgICAgICAgICAgXG4gICAgICAgICAgICAvKiAg0JjQvdC40YbQuNCw0LvQuNC30LjRgNGD0LXQvCDQutC+0L3RgtC10LnQvdC10YAg0LTQu9GPINC30LDQv9C40YHQtdC5ICovXG4gICAgICAgICAgICB2YXIgJGVudHJpZXMgPSAkKFwiLndyYXBwZXJfX2NvbnRlbnRcIik7XG5cbiAgICAgICAgICAgIC8qINCS0LXRiNCw0LXQvCDQvtCx0YDQsNCx0L7RgtGH0LjQutC4IG9ubGljayDQvdCwINGB0YHRi9C70LrQuCAqL1xuICAgICAgICAgICAgdmFyICRwYWdlX2xpbmtzID0gJChcIi5uYXZcIiksXG4gICAgICAgICAgICAgICAgJHByZXZfbGluayA9ICRwYWdlX2xpbmtzLmZpbmQoXCJhLm5hdl9faXRlbV9fbGlua1wiKSxcbiAgICAgICAgICAgICAgICAkbmV4dF9saW5rID0gJHBhZ2VfbGlua3MuZmluZChcImEubmF2X19pdGVtX19saW5rXCIpO1xuICAgICAgICAgICAgJHBhZ2VfbGlua3MuZGVsZWdhdGUoXCJhXCIsIFwiY2xpY2tcIiwgZnVuY3Rpb24gKGUpIHtcbiAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG4gICAgICAgICAgICAgICAgdmFyIHVybCA9ICQodGhpcykuYXR0cihcImhyZWZcIik7XG5cbiAgICAgICAgICAgICAgICAvKiAg0KPQtNCw0LvRj9C10Lwg0YLQtdC60YPRidC40LUg0LfQsNC/0LjRgdC4INC40Lcg0LrQvtC90YLQtdC50L3QtdGA0LAgKi9cbiAgICAgICAgICAgICAgICAkZW50cmllcy5lbXB0eSgpO1xuXG4gICAgICAgICAgICAgICAgLyogINCf0L7QutCw0LfRi9Cy0LDQtdC8INC40L3QtNC40LrQsNGC0L7RgCDQt9Cw0LPRgNGD0LfQutC4ICovXG4gICAgICAgICAgICAgICAgJGVudHJpZXMuYWRkQ2xhc3MoXCJsb2FkaW5nXCIpO1xuXG4gICAgICAgICAgICAgICAgLyogINCYINGB0L7QvtCx0YnQsNC10LwgSGlzdG9yeS5qcyDQvtCxINC40LfQvNC10L3QtdC90LjQuCDRgdC+0YHRgtC+0Y/QvdC40Y8g0YHRgtGA0LDQvdC40YbRi1xuICAgICAgICAgICAgICAgINCSINC60LDRh9C10YHRgtCy0LUg0L/QtdGA0LLQvtCz0L4g0LDQs9GA0YPQvNC10L3RgtCwINC80L7QttC90L4g0L/QtdGA0LXQtNCw0YLRjCDQv9GA0L7QuNC30LLQvtC70YzQvdGL0Lkg0L7QsdGK0LXQutGCXG4gICAgICAgICAgICAgICAg0YEg0LTQvtC/0L7Qu9C90LjRgtC10LvRjNC90YvQvNC4INC00LDQvdC90YvQvNC4LCDQutC+0YLQvtGA0YvQtSDQvNC+0LbQvdC+INC40LfQstC70LXRh9GMINCyINC+0LHRgNCw0LHQvtGC0YfQuNC60LVcbiAgICAgICAgICAgICAgICDQuNC30LzQtdC90LXQvdC40Y8g0YHQvtGB0YLQvtGP0L3QuNGPLCDQvtC/0LjRgdCw0L3QvdC+0Lwg0L3QuNC20LUuXG4gICAgICAgICAgICAgICAg0JIg0L3QsNGI0LXQvCDRgdC70YPRh9Cw0LUg0Y3RgtC+INCx0YPQtNC10YIg0L/Rg9GB0YLQvtC5INC+0LHRitC10LrRgi4gKi9cbiAgICAgICAgICAgICAgICB3aW5kb3cuaGlzdG9yeS5wdXNoU3RhdGUoe30sIG51bGwsIHVybCk7XG4gICAgICAgICAgICB9KTtcblxuICAgICAgICAgICAgLyogINCT0L7RgtC+0LLQuNC8INC+0LHRgNCw0LHQvtGC0YfQuNC6INC40LfQvNC10L3QtdC90LjRjyDRgdC+0YHRgtC+0Y/QvdC40Y8g0YHRgtGA0LDQvdC40YbRiyAqL1xuICAgICAgICAgICAgd2luZG93Lmhpc3RvcnkuQWRhcHRlci5iaW5kKHdpbmRvdywgXCJzdGF0ZWNoYW5nZVwiLCBmdW5jdGlvbiAoKSB7XG4gICAgICAgICAgICAgICAgLyogINCf0L7Qu9GD0YfQsNC10Lwg0LjQvdGE0L7RgNC80LDRhtC40Y4g0L4g0YHQvtGB0YLQvtGP0L3QuNC4INGB0YLRgNCw0L3QuNGG0YsgKi9cbiAgICAgICAgICAgICAgICB2YXIgc3RhdGUgPSB3aW5kb3cuaGlzdG9yeS5nZXRTdGF0ZSgpO1xuXG4gICAgICAgICAgICAgICAgLyog0J/QvtC70YPRh9Cw0LXQvCBVUkwg0L3QvtCy0L7Qs9C+INGB0L7RgdGC0L7Rj9C90LjRjy4g0K3RgtC+IFVSTCwg0LrQvtGC0L7RgNGL0Lkg0LzRiyDQv9C10YDQtdC00LDQu9C4XG4gICAgICAgICAgICAgICAg0LIgLnB1c2hTdGF0ZSgpICovXG4gICAgICAgICAgICAgICAgdmFyIHVybCA9IHN0YXRlLnVybDtcblxuICAgICAgICAgICAgICAgIC8qICDQotGD0YIg0LzQvtC20L3QviDQuNC30LLQu9C10YfRjCDQtNC+0L/QvtC70L3QuNGC0LXQu9GM0L3Ri9C1INC00LDQvdC90YvQtSwg0L4g0LrQvtGC0L7RgNGL0YUg0YjQu9CwINGA0LXRh9GMINCy0YvRiNC1LlxuICAgICAgICAgICAgICAgINCd0LDQv9GA0LjQvNC10YAsINGC0LDQujogdmFyIGRhdGEgPSBzdGF0ZS5kYXRhOyAqL1xuXG4gICAgICAgICAgICAgICAgLyogINCe0YLQv9GA0LDQstC70Y/QtdC8IEFKQVgt0LfQsNC/0YDQvtGBINC90LAg0YHQtdGA0LLQtdGALlxuICAgICAgICAgICAgICAgINCSINC60LDRh9C10YHRgtCy0LUg0L7RgtCy0LXRgtCwINC80Ysg0L7QttC40LTQsNC10LwgSlNPTi3QvtCx0YrQtdC60YIg0YHQu9C10LTRg9GO0YnQtdCz0L4g0YTQvtGA0LzQsNGC0LA6XG4gICAgICAgICAgICAgICAge2VudHJpZXM6IFwiPGFydGljbGU+PGgxPi4uLjwvaDE+Li4uPC9hcnRpY2xlPiA8YXJ0aWNsZT4uLi5cIixcbiAgICAgICAgICAgICAgICAgdGl0bGU6IFwi0KHRgtGA0LDQvdC40YbQsCAzXCIsXG4gICAgICAgICAgICAgICAgIG5leHRfdXJsOiBcIi9ibG9nL3BhZ2UvNFwiLFxuICAgICAgICAgICAgICAgICBwcmV2X3VybDogXCIvYmxvZy9wYWdlLzJcIiB9XG4gICAgICAgICAgICAgICAg0JrQsNC60LjQvCDQvtCx0YDQsNC30L7QvCDQsdGD0LTQtdGCINGB0YTQvtGA0LzQuNGA0L7QstCw0L0g0Y3RgtC+0YIg0L7RgtCy0LXRgiwg0LfQsNCy0LjRgdC40YIg0YLQvtC70YzQutC+INC+0YIg0LLQsNGBLiAqL1xuICAgICAgICAgICAgICAgICQuZ2V0SlNPTih1cmwsIGZ1bmN0aW9uIChyZXNwb25zZSkge1xuXG4gICAgICAgICAgICAgICAgICAgIC8qICDQntCx0L3QvtCy0LvRj9C10Lwg0LfQsNCz0L7Qu9C+0LLQvtC6INGB0YLRgNCw0L3QuNGG0YsgKi9cbiAgICAgICAgICAgICAgICAgICAgJChcInRpdGxlXCIpLnRleHQocmVzcG9uc2UudGl0bGUpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8qICDQntCx0L3QvtCy0LvRj9C10Lwg0YHRgdGL0LvQutC4INC90LAg0L/RgNC10LTRi9C00YPRidGD0Y4g0Lgg0YHQu9C10LTRg9GO0YnRg9GOINGB0YLRgNCw0L3QuNGG0YsgKi9cbiAgICAgICAgICAgICAgICAgICAgJHByZXZfbGluay5hdHRyKFwiaHJlZlwiLCByZXNwb25zZS5wcmV2X3VybCk7XG4gICAgICAgICAgICAgICAgICAgICRuZXh0X2xpbmsuYXR0cihcImhyZWZcIiwgcmVzcG9uc2UubmV4dF91cmwpO1xuXG4gICAgICAgICAgICAgICAgICAgIC8qICDQmCwg0L3QsNC60L7QvdC10YYsINC/0L7QutCw0LfRi9Cy0LDQtdC8INC90L7QstGL0Lkg0LHQu9C+0Log0LfQsNC/0LjRgdC10LkgKi9cbiAgICAgICAgICAgICAgICAgICAgJGVudHJpZXMucmVtb3ZlQ2xhc3MoXCJsb2FkaW5nXCIpLmh0bWwocmVzcG9uc2UuZW50cmllcyk7XG4gICAgICAgICAgICAgICAgfSk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxufSkoZG9jdW1lbnQuYm9keSk7XG5cbi8vIChmdW5jdGlvbih3aW5kb3csdW5kZWZpbmVkKXtcblxuLy8gICAgIC8vIENoZWNrIExvY2F0aW9uXG4vLyAgICAgaWYgKCBkb2N1bWVudC5sb2NhdGlvbi5wcm90b2NvbCA9PT0gJ2ZpbGU6JyApIHtcbi8vICAgICAgICAgYWxlcnQoJ1RoZSBIVE1MNSBIaXN0b3J5IEFQSSAoYW5kIHRodXMgSGlzdG9yeS5qcykgZG8gbm90IHdvcmsgb24gZmlsZXMsIHBsZWFzZSB1cGxvYWQgaXQgdG8gYSBzZXJ2ZXIuJyk7XG4vLyAgICAgfVxuXG4vLyAgICAgLy8gRXN0YWJsaXNoIFZhcmlhYmxlc1xuLy8gICAgIHZhclxuLy8gICAgICAgICBIaXN0b3J5ID0gd2luZG93Lkhpc3RvcnksIC8vIE5vdGU6IFdlIGFyZSB1c2luZyBhIGNhcGl0YWwgSCBpbnN0ZWFkIG9mIGEgbG93ZXIgaFxuLy8gICAgICAgICBTdGF0ZSA9IEhpc3RvcnkuZ2V0U3RhdGUoKSxcbi8vICAgICAgICAgJGxvZyA9ICQoJyNsb2cnKTtcblxuLy8gICAgIC8vIExvZyBJbml0aWFsIFN0YXRlXG4vLyAgICAgSGlzdG9yeS5sb2coJ2luaXRpYWw6JywgU3RhdGUuZGF0YSwgU3RhdGUudGl0bGUsIFN0YXRlLnVybCk7XG5cbi8vICAgICAvLyBCaW5kIHRvIFN0YXRlIENoYW5nZVxuLy8gICAgIEhpc3RvcnkuQWRhcHRlci5iaW5kKHdpbmRvdywnc3RhdGVjaGFuZ2UnLGZ1bmN0aW9uKCl7IC8vIE5vdGU6IFdlIGFyZSB1c2luZyBzdGF0ZWNoYW5nZSBpbnN0ZWFkIG9mIHBvcHN0YXRlXG4vLyAgICAgICAgIC8vIExvZyB0aGUgU3RhdGVcbi8vICAgICAgICAgdmFyIFN0YXRlID0gSGlzdG9yeS5nZXRTdGF0ZSgpOyAvLyBOb3RlOiBXZSBhcmUgdXNpbmcgSGlzdG9yeS5nZXRTdGF0ZSgpIGluc3RlYWQgb2YgZXZlbnQuc3RhdGVcbi8vICAgICAgICAgSGlzdG9yeS5sb2coJ3N0YXRlY2hhbmdlOicsIFN0YXRlLmRhdGEsIFN0YXRlLnRpdGxlLCBTdGF0ZS51cmwpO1xuLy8gICAgIH0pO1xuXG4vLyAgICAgLy8gUHJlcGFyZSBCdXR0b25zXG4vLyAgICAgdmFyXG4vLyAgICAgICAgIGJ1dHRvbnMgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnYnV0dG9ucycpLFxuLy8gICAgICAgICBzY3JpcHRzID0gW1xuLy8gICAgICAgICAgICAgJ0hpc3RvcnkucHVzaFN0YXRlKHtzdGF0ZToxLHJhbmQ6TWF0aC5yYW5kb20oKX0sIFwiU3RhdGUgMVwiLCBcIj9zdGF0ZT0xXCIpOyAvLyBsb2dzIHtzdGF0ZToxLHJhbmQ6XCJzb21lIHJhbmRvbSB2YWx1ZVwifSwgXCJTdGF0ZSAxXCIsIFwiP3N0YXRlPTFcIicsXG4vLyAgICAgICAgICAgICAnSGlzdG9yeS5wdXNoU3RhdGUoe3N0YXRlOjIscmFuZDpNYXRoLnJhbmRvbSgpfSwgXCJTdGF0ZSAyXCIsIFwiP3N0YXRlPTJcIik7IC8vIGxvZ3Mge3N0YXRlOjIscmFuZDpcInNvbWUgcmFuZG9tIHZhbHVlXCJ9LCBcIlN0YXRlIDJcIiwgXCI/c3RhdGU9MlwiJyxcbi8vICAgICAgICAgICAgICdIaXN0b3J5LnJlcGxhY2VTdGF0ZSh7c3RhdGU6MyxyYW5kOk1hdGgucmFuZG9tKCl9LCBcIlN0YXRlIDNcIiwgXCI/c3RhdGU9M1wiKTsgLy8gbG9ncyB7c3RhdGU6MyxyYW5kOlwic29tZSByYW5kb20gdmFsdWVcIn0sIFwiU3RhdGUgM1wiLCBcIj9zdGF0ZT0zXCInLFxuLy8gICAgICAgICAgICAgJ0hpc3RvcnkucHVzaFN0YXRlKG51bGwsIG51bGwsIFwiP3N0YXRlPTRcIik7IC8vIGxvZ3Mge30sIFwiXCIsIFwiP3N0YXRlPTRcIicsXG4vLyAgICAgICAgICAgICAnSGlzdG9yeS5iYWNrKCk7IC8vIGxvZ3Mge3N0YXRlOjN9LCBcIlN0YXRlIDNcIiwgXCI/c3RhdGU9M1wiJyxcbi8vICAgICAgICAgICAgICdIaXN0b3J5LmJhY2soKTsgLy8gbG9ncyB7c3RhdGU6MX0sIFwiU3RhdGUgMVwiLCBcIj9zdGF0ZT0xXCInLFxuLy8gICAgICAgICAgICAgJ0hpc3RvcnkuYmFjaygpOyAvLyBsb2dzIHt9LCBcIlRoZSBwYWdlIHlvdSBzdGFydGVkIGF0XCIsIFwiP1wiJyxcbi8vICAgICAgICAgICAgICdIaXN0b3J5LmdvKDIpOyAvLyBsb2dzIHtzdGF0ZTozfSwgXCJTdGF0ZSAzXCIsIFwiP3N0YXRlPTNcIidcbi8vICAgICAgICAgXSxcbi8vICAgICAgICAgYnV0dG9uc0hUTUwgPSAnJ1xuLy8gICAgICAgICA7XG5cbi8vICAgICAvLyBBZGQgQnV0dG9uc1xuLy8gICAgIGZvciAoIHZhciBpPTAsbj1zY3JpcHRzLmxlbmd0aDsgaTxuOyArK2kgKSB7XG4vLyAgICAgICAgIHZhciBfc2NyaXB0ID0gc2NyaXB0c1tpXTtcbi8vICAgICAgICAgYnV0dG9uc0hUTUwgKz1cbi8vICAgICAgICAgICAgICc8bGk+PGJ1dHRvbiBvbmNsaWNrPVxcJ2phdmFzY3JpcHQ6Jytfc2NyaXB0KydcXCc+Jytfc2NyaXB0Kyc8L2J1dHRvbj48L2xpPic7XG4vLyAgICAgfVxuLy8gICAgIGJ1dHRvbnMuaW5uZXJIVE1MID0gYnV0dG9uc0hUTUw7XG5cbi8vIH0pKHdpbmRvdyk7IiwidmFyIGFwcCA9IGFwcCB8fCB7fTtcblxuKGZ1bmN0aW9uKGJvZHkpe1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYXBwLnByZWxvYWQgPSB7XG5cbiAgICAgICAgcHJlbG9hZDogZnVuY3Rpb24oJGltYWdlKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgdXJsID0gJGltYWdlLmRhdGEoJ3ByZWxvYWQnKSwgaW1hZ2UgPSBudWxsO1xuXG4gICAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgICAgIGltYWdlID0gbmV3IEltYWdlKCk7XG4gICAgICAgICAgICAgICAgaW1hZ2Uub25sb2FkID0gZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICAgICAgICAgICRpbWFnZS5hdHRyKCdzcmMnLCB1cmwpO1xuICAgICAgICAgICAgICAgIH07XG4gICAgICAgICAgICAgICAgaW1hZ2Uuc3JjID0gdXJsO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgICAgICAkaW1hZ2UuYXR0cignc3JjJywgdXJsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgJGltYWdlLnJlbW92ZUF0dHIoJ3dpZHRoIGhlaWdodCcpO1xuICAgICAgICAgICAgJGltYWdlLmRhdGEoJ3ByZWxvYWQnLCAnJyk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAoJCgnaW1nW2RhdGEtcHJlbG9hZF0nKS5sZW5ndGgpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcztcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgICQoJ2ltZ1tkYXRhLXByZWxvYWRdJykuZWFjaChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICAgICAoZnVuY3Rpb24oJGltYWdlKXtcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLnByZWxvYWQoJGltYWdlKTtcbiAgICAgICAgICAgICAgICAgICAgfSkoJCh0aGlzKSlcbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgfTtcblxufSkoZG9jdW1lbnQuYm9keSk7IiwidmFyIGFwcCA9IGFwcCB8fCB7fTtcblxuKGZ1bmN0aW9uKGJvZHkpe1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYXBwLnF1YW50aXR5ID0ge1xuXG4gICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAgZWxlbWVudDogJy5qLXF1YW50aXR5JyxcbiAgICAgICAgICAgIGlucHV0OiAnLmotcXVhbnRpdHktY291bnQnLFxuICAgICAgICAgICAgY29udHJvbDogJy5qLXF1YW50aXR5LWNvbnRyb2wnLFxuICAgICAgICAgICAgY29tcGxldGU6IG51bGxcbiAgICAgICAgfSxcblxuICAgICAgICBlbGVtZW50OiBudWxsLFxuXG4gICAgICAgIGV4dGVuZDogZnVuY3Rpb24oY29uZmlnKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbmZpZyAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIHg7XG4gICAgICAgICAgICAgICAgZm9yICh4IGluIGNvbmZpZylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgX3RoaXMuY29uZmlnW3hdICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbmZpZ1t4XSA9IGNvbmZpZ1t4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2V0VmFsdWU6IGZ1bmN0aW9uKHF1YW50aXR5KVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgbWluID0gMSwgbWF4ID0gMTAwO1xuXG4gICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmRhdGEoJ21pbicpKSB7XG4gICAgICAgICAgICAgICAgbWluID0gdGhpcy5lbGVtZW50LmRhdGEoJ21pbicpOyAgIFxuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICBpZiAodGhpcy5lbGVtZW50LmRhdGEoJ21heCcpKSB7XG4gICAgICAgICAgICAgICAgbWF4ID0gdGhpcy5lbGVtZW50LmRhdGEoJ21heCcpOyAgIFxuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICBpZiAocXVhbnRpdHkgPiBtYXgpIHtcbiAgICAgICAgICAgICAgICBxdWFudGl0eSA9IG1heDtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIFxuICAgICAgICAgICAgaWYgKHF1YW50aXR5IDwgbWluKSB7XG4gICAgICAgICAgICAgICAgcXVhbnRpdHkgPSBtaW47XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuZWxlbWVudC5maW5kKHRoaXMuY29uZmlnLmlucHV0KS52YWwocXVhbnRpdHkpO1xuXG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5jcmVhc2U6IGZ1bmN0aW9uKHF1YW50aXR5KVxuICAgICAgICB7XG4gICAgICAgICAgICBxdWFudGl0eSArPSAxO1xuXG4gICAgICAgICAgICB0aGlzLnNldFZhbHVlKHF1YW50aXR5KTtcbiAgICAgICAgfSxcblxuICAgICAgICBkZWNyZWFzZTogZnVuY3Rpb24ocXVhbnRpdHkpXG4gICAgICAgIHtcbiAgICAgICAgICAgIGlmIChxdWFudGl0eSA+IDEpIHtcbiAgICAgICAgICAgICAgICBxdWFudGl0eSAtPSAxO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB0aGlzLnNldFZhbHVlKHF1YW50aXR5KTtcbiAgICAgICAgfSxcblxuICAgICAgICBjYWxsYmFjazogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBpZiAodHlwZW9mKHRoaXMuZWxlbWVudC5kYXRhKCdwcm9kdWN0JykpICE9PSAndW5kZWZpbmVkJyAmJiB0eXBlb2YodGhpcy5jb25maWcuY29tcGxldGUpID09ICdmdW5jdGlvbicpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdGhpcy5jb25maWcuY29tcGxldGUuY2FsbChudWxsLCB0aGlzLmVsZW1lbnQsIHRoaXMuZWxlbWVudC5kYXRhKCdwcm9kdWN0JykpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9LFxuXG4gICAgICAgIGtleXM6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgdmFyIF90aGlzID0gdGhpcywgcm9sZSA9ICcnO1xuXG4gICAgICAgICAgICAkKCdib2R5Jykub24oJ2tleWRvd24nLCBfdGhpcy5jb25maWcuaW5wdXQsIGZ1bmN0aW9uKGUpIHtcbiAgICAgICAgICAgICAgICBpZiAoWzM4LCA0MF0uaW5kZXhPZihlLmtleUNvZGUpID49IDApXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7XG5cbiAgICAgICAgICAgICAgICAgICAgcm9sZSA9IHtcbiAgICAgICAgICAgICAgICAgICAgICAgIDM4OiAnaW5jcmVhc2UnLFxuICAgICAgICAgICAgICAgICAgICAgICAgNDA6ICdkZWNyZWFzZSdcbiAgICAgICAgICAgICAgICAgICAgfTtcblxuICAgICAgICAgICAgICAgICAgICBfdGhpcy5lbGVtZW50ID0gJCh0aGlzKS5jbG9zZXN0KF90aGlzLmNvbmZpZy5lbGVtZW50KTtcblxuICAgICAgICAgICAgICAgICAgICBfdGhpc1tyb2xlW2Uua2V5Q29kZV1dKHBhcnNlSW50KF90aGlzLmVsZW1lbnQuZmluZChfdGhpcy5jb25maWcuaW5wdXQpLnZhbCgpKSk7XG5cbiAgICAgICAgICAgICAgICAgICAgX3RoaXMuY2FsbGJhY2soKTtcblxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gZmFsc2U7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgYmluZDogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICB2YXIgX3RoaXMgPSB0aGlzLCByb2xlID0gJyc7XG5cbiAgICAgICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCBfdGhpcy5jb25maWcuY29udHJvbCwgZnVuY3Rpb24oZSkge1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgIF90aGlzLmVsZW1lbnQgPSAkKHRoaXMpLmNsb3Nlc3QoX3RoaXMuY29uZmlnLmVsZW1lbnQpO1xuXG4gICAgICAgICAgICAgICAgcm9sZSA9ICQodGhpcykuZGF0YSgncm9sZScpO1xuICAgICAgICAgXG4gICAgICAgICAgICAgICAgaWYoWydpbmNyZWFzZScsICdkZWNyZWFzZSddLmluZGV4T2Yocm9sZSkgPj0gMClcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIF90aGlzW3JvbGVdKHBhcnNlSW50KF90aGlzLmVsZW1lbnQuZmluZChfdGhpcy5jb25maWcuaW5wdXQpLnZhbCgpKSk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgX3RoaXMuY2FsbGJhY2soKTtcblxuICAgICAgICAgICAgICAgIHJldHVybiAhMTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9LFxuXG4gICAgICAgIGluaXQ6IGZ1bmN0aW9uKGNvbmZpZylcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKHR5cGVvZiBjb25maWcgIT09ICd1bmRlZmluZWQnKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHRoaXMuZXh0ZW5kKGNvbmZpZyk7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIHRoaXMuYmluZCgpO1xuICAgICAgICAgICAgdGhpcy5rZXlzKCk7XG4gICAgICAgIH1cblxuICAgIH07XG5cbn0pKGRvY3VtZW50LmJvZHkpO1xuXG4vLyB0aGlzLnF1YW50aXR5LmluaXQoe1xuLy8gICAgIGNvbXBsZXRlOiBmdW5jdGlvbihlbGVtZW50LCBpZCkge1xuLy8gICAgICAgICAvLyAkKGVsZW1lbnQpLmNzcyh7XG4vLyAgICAgICAgIC8vICAgICAnYm9yZGVyJzogJzFweCBzb2xpZCBsaW1lJ1xuLy8gICAgICAgICAvLyB9KTtcblxuLy8gICAgICAgICBjb25zb2xlLmxvZyhcImlkIDpcIiwgaWQpO1xuLy8gICAgIH1cbi8vIH0pO1xuXG4vLyA8ZGl2IGNsYXNzPVwicXVhbnRpdHkgai1xdWFudGl0eSBjbGVhcmZpeFwiIGRhdGEtcHJvZHVjdD1cIjEwMDBcIiBkYXRhLW1pbj1cIjFcIiBkYXRhLW1heD1cIjk5OVwiPlxuLy8gICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwicXVhbnRpdHlfX2NvbnRyb2wgX2RlY3JlYXNlIGotcXVhbnRpdHktY29udHJvbFwiIGRhdGEtcm9sZT1cImRlY3JlYXNlXCI+PC9idXR0b24+XG4vLyAgICAgPGlucHV0IHR5cGU9XCJ0ZXh0XCIgbmFtZT1cImNvdW50WzEwMDBdXCIgdmFsdWU9XCIxXCIgZGF0YS1yb2xlPVwicXVhbnRpdHktaW5wdXRcIiBjbGFzcz1cInF1YW50aXR5X19jb3VudCBqLXF1YW50aXR5LWNvdW50XCIgbWF4bGVuZ3RoPVwiM1wiIGF1dG9jb21wbGV0ZT1cIm9mZlwiPlxuLy8gICAgIDxidXR0b24gdHlwZT1cImJ1dHRvblwiIGNsYXNzPVwicXVhbnRpdHlfX2NvbnRyb2wgX2luY3JlYXNlIGotcXVhbnRpdHktY29udHJvbFwiIGRhdGEtcm9sZT1cImluY3JlYXNlXCI+PC9idXR0b24+XG4vLyA8L2Rpdj4iLCJ2YXIgYXBwID0gYXBwIHx8IHt9O1xuXG47KGZ1bmN0aW9uKGJvZHkpe1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgdmFyIF90aGlzO1xuXG4gICAgYXBwLnNhbmR3aWNoID0ge1xuXG4gICAgICAgIGNvbmZpZzoge1xuICAgICAgICAgICAga2V5SG9va3M6ICExLFxuICAgICAgICAgICAgc2VsZWN0b3I6ICcuanMtc2FuZHdpY2gtbWVudScsXG4gICAgICAgICAgICB3cmFwcGVyOiAnLmxheW91dC13cmFwcGVyJyxcbiAgICAgICAgICAgIG92ZXJsYXk6ICcub3ZlcmxheSdcbiAgICAgICAgfSxcblxuICAgICAgICBleHRlbmQ6IGZ1bmN0aW9uKGNvbmZpZylcbiAgICAgICAge1xuICAgICAgICAgICAgX3RoaXMgPSB0aGlzO1xuXG4gICAgICAgICAgICBpZiAodHlwZW9mIGNvbmZpZyAhPT0gJ3VuZGVmaW5lZCcpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgdmFyIHg7XG4gICAgICAgICAgICAgICAgZm9yICh4IGluIGNvbmZpZylcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgIGlmICh0eXBlb2YgX3RoaXMuY29uZmlnW3hdICE9PSAndW5kZWZpbmVkJylcbiAgICAgICAgICAgICAgICAgICAgICAgIF90aGlzLmNvbmZpZ1t4XSA9IGNvbmZpZ1t4XTtcbiAgICAgICAgICAgICAgICB9XG4gICAgICAgICAgICB9XG4gICAgICAgIH0sXG5cbiAgICAgICAgaXNPcGVuOiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIHJldHVybiAkKCdib2R5JykuaGFzQ2xhc3MoJ3BhZ2UtdmlzaWJsZScpO1xuICAgICAgICB9LFxuXG4gICAgICAgIGhpZGU6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdwYWdlLW9wZW4nKTtcblxuICAgICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbigpe1xuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5yZW1vdmVDbGFzcygncGFnZS12aXNpYmxlJyk7XG4gICAgICAgICAgICB9LCAxMCk7XG5cbiAgICAgICAgICAgICQodGhpcy5jb25maWcub3ZlcmxheSkuY3NzKHtcbiAgICAgICAgICAgICAgICAndmlzaWJpbGl0eSc6ICdoaWRkZW4nXG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICB0b2dnbGU6IGZ1bmN0aW9uKClcbiAgICAgICAge1xuICAgICAgICAgICAgaWYgKCQoJ2JvZHknKS5oYXNDbGFzcygncGFnZS12aXNpYmxlJykpXG4gICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdwYWdlLW9wZW4nKTtcblxuICAgICAgICAgICAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24oKXtcbiAgICAgICAgICAgICAgICAgICAgJCgnYm9keScpLnJlbW92ZUNsYXNzKCdwYWdlLXZpc2libGUnKTtcbiAgICAgICAgICAgICAgICB9LCAyMDApO1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgZWxzZVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygncGFnZS1vcGVuJyk7XG5cbiAgICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uKCl7XG4gICAgICAgICAgICAgICAgICAgICQoJ2JvZHknKS5hZGRDbGFzcygncGFnZS12aXNpYmxlJyk7XG4gICAgICAgICAgICAgICAgfSwgMTApO1xuICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICB2YXIgdmlzaWJpbGl0eSA9ICd2aXNpYmxlJztcblxuICAgICAgICAgICAgaWYgKCEkKCdib2R5JykuaGFzQ2xhc3MoJ3BhZ2Utb3BlbicpKVxuICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgIHZpc2liaWxpdHkgPSAnaGlkZGVuJ1xuICAgICAgICAgICAgfVxuICAgICAgICAgICAgXG4gICAgICAgICAgICAkKF90aGlzLmNvbmZpZy5vdmVybGF5KS5jc3Moe1xuICAgICAgICAgICAgICAgICd2aXNpYmlsaXR5JzogdmlzaWJpbGl0eVxuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgc2FuZHdpY2hUcmlnZ2VyOiBmdW5jdGlvbigpXG4gICAgICAgIHtcbiAgICAgICAgICAgIF90aGlzID0gdGhpcztcblxuICAgICAgICAgICAgaWYgKF90aGlzLmNvbmZpZy5rZXlIb29rcylcbiAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAkKCdib2R5Jykub24oJ2tleWRvd24nLCBmdW5jdGlvbihlKSB7XG4gICAgICAgICAgICAgICAgICAgIGlmKGUua2V5Q29kZSA9PSAyNyAmJiBfdGhpcy5pc09wZW4oKSlcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgX3RoaXMudG9nZ2xlKCk7XG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICB9KTtcbiAgICAgICAgICAgIH07XG5cbiAgICAgICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCBfdGhpcy5jb25maWcuc2VsZWN0b3IsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQgPyBlLnByZXZlbnREZWZhdWx0KCkgOiBlLnJldHVyblZhbHVlID0gZmFsc2U7XG4gICAgICAgICAgICAgICAgX3RoaXMudG9nZ2xlKCk7XG4gICAgICAgICAgICB9KTtcbiAgICAgICAgfSxcblxuICAgICAgICBvdmVybGF5VHJpZ2dlcjogZnVuY3Rpb24oKVxuICAgICAgICB7XG4gICAgICAgICAgICBfdGhpcyA9IHRoaXM7XG5cbiAgICAgICAgICAgICQoJ2JvZHknKS5vbignY2xpY2snLCBfdGhpcy5jb25maWcub3ZlcmxheSwgZnVuY3Rpb24oZSl7XG4gICAgICAgICAgICAgICAgX3RoaXMuaGlkZSgpO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH0sXG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oY29uZmlnKVxuICAgICAgICB7XG4gICAgICAgICAgICB0aGlzLmV4dGVuZChjb25maWcpO1xuICAgICAgICAgICAgdGhpcy5zYW5kd2ljaFRyaWdnZXIoKTtcbiAgICAgICAgICAgIHRoaXMub3ZlcmxheVRyaWdnZXIoKTtcbiAgICAgICAgfVxuXG4gICAgfTtcblxufSkoZG9jdW1lbnQuYm9keSk7IiwidmFyIGFwcCA9IGFwcCB8fCB7fTtcblxuKGZ1bmN0aW9uKGJvZHkpe1xuICAgIFwidXNlIHN0cmljdFwiO1xuXG4gICAgYXBwLnRhYnMgPSB7XG5cbiAgICAgICAgaW5pdDogZnVuY3Rpb24oKSB7XG4gICAgICAgICAgICB2YXIgJHdyYXBwZXIgPSBudWxsLCB0YWIgPSAnJztcblxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsICcuai10YWItdHJpZ2dlcicsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgIGlmICghJCh0aGlzKS5oYXNDbGFzcygnX29wZW4nKSkge1xuICAgICAgICAgICAgICAgICAgICB0YWIgPSAkKHRoaXMpLmRhdGEoJ3RhYicpO1xuXG4gICAgICAgICAgICAgICAgICAgICR3cmFwcGVyID0gJCh0aGlzKS5jbG9zZXN0KCcuai10YWItd3JhcHBlcicpO1xuXG4gICAgICAgICAgICAgICAgICAgICR3cmFwcGVyLmZpbmQoJy5qLXRhYi10cmlnZ2VyJykucmVtb3ZlQ2xhc3MoJ19jdXJyZW50Jyk7XG4gICAgICAgICAgICAgICAgICAgICR3cmFwcGVyLmZpbmQoJy5qLXRhYi1pdGVtJykucmVtb3ZlQ2xhc3MoJ19vcGVuJyk7XG5cbiAgICAgICAgICAgICAgICAgICAgJHdyYXBwZXIuZmluZCgnI3RhYi0nK3RhYikuYWRkQ2xhc3MoJ19vcGVuJyk7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuYWRkQ2xhc3MoJ19jdXJyZW50Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgcmV0dXJuICExO1xuICAgICAgICAgICAgfSk7XG4gICAgICAgIH1cblxuICAgIH07XG5cbn0pKGRvY3VtZW50LmJvZHkpOyIsInZhciBhcHAgPSBhcHAgfHwge307XG5cbihmdW5jdGlvbihib2R5KXtcbiAgICBcInVzZSBzdHJpY3RcIjtcblxuICAgIGFwcC50b2dnbGUgPSB7XG4gICAgICAgIFxuICAgICAgICBpbml0OiBmdW5jdGlvbigpIHtcbiAgICAgICAgICAgIFxuICAgICAgICAgICAgdmFyICR0b2dnbGUgPSBudWxsLCB0ZXh0ID0gJycsIGhpZGUgPSB0cnVlLCByZW1vdmUgPSBmYWxzZTtcblxuICAgICAgICAgICAgJCgnYm9keScpLm9uKCdjbGljaycsICcuai10b2dnbGUtdHJpZ2dlcicsIGZ1bmN0aW9uKGUpe1xuICAgICAgICAgICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcblxuICAgICAgICAgICAgICAgICR0b2dnbGUgPSAkKHRoaXMpLmNsb3Nlc3QoJy5qLXRvZ2dsZScpLmZpbmQoJy5qLXRvZ2dsZS1pdGVtJyk7XG5cbiAgICAgICAgICAgICAgICBpZiAoJHRvZ2dsZSlcbiAgICAgICAgICAgICAgICB7XG4gICAgICAgICAgICAgICAgICAgICR0b2dnbGUudG9nZ2xlQ2xhc3MoJ2lzLXNob3cnKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoJHRvZ2dsZS5oYXNDbGFzcygnaXMtaGlkZGVuJykpXG4gICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAkdG9nZ2xlLnJlbW92ZUNsYXNzKCdpcy1oaWRkZW4nKTtcbiAgICAgICAgICAgICAgICB9XG5cbiAgICAgICAgICAgICAgICBpZiAoJCh0aGlzKS5kYXRhKCd0b2dnbGUtdGV4dCcpKSB7XG4gICAgICAgICAgICAgICAgICAgIHRleHQgPSAkKHRoaXMpLmRhdGEoJ3RvZ2dsZS10ZXh0Jyk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHR5cGVvZigkKHRoaXMpLmRhdGEoJ3JlbW92ZScpKSAhPT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgICAgICAgICAgICAgcmVtb3ZlID0gJCh0aGlzKS5kYXRhKCdyZW1vdmUnKSA9PSAnMCcgPyBmYWxzZSA6ICgkKHRoaXMpLmRhdGEoJ3JlbW92ZScpID09ICcxJyA/IHRydWUgOiBmYWxzZSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIFxuICAgICAgICAgICAgICAgIGlmIChoaWRlKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykuaGlkZSgpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBcbiAgICAgICAgICAgICAgICBpZiAocmVtb3ZlKSB7XG4gICAgICAgICAgICAgICAgICAgICQodGhpcykucmVtb3ZlKCk7XG4gICAgICAgICAgICAgICAgfVxuXG4gICAgICAgICAgICAgICAgaWYgKHRleHQpIHtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5kYXRhKCd0b2dnbGUtdGV4dCcsICQodGhpcykuaHRtbCgpKTtcbiAgICAgICAgICAgICAgICAgICAgJCh0aGlzKS5odG1sKHRleHQpO1xuICAgICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICAgIHJldHVybiBmYWxzZTtcbiAgICAgICAgICAgIH0pXG5cbiAgICAgICAgfVxuXG4gICAgfTtcblxufSkoZG9jdW1lbnQuYm9keSk7XG5cbi8vIDxkaXYgY2xhc3M9XCJqLXRvZ2dsZVwiPlxuLy8gICAgIDxkaXYgY2xhc3M9XCJqLXRvZ2dsZS1pdGVtXCI+IGNvbnRlbnQgPC9kaXY+XG4vLyAgICAgPHNwYW4gY2xhc3M9XCJqLXRvZ2dsZS10cmlnZ2VyXCIgZGF0YS10b2dnbGUtdGV4dD1cItCh0LrRgNGL0YLRjC4uLlwiIGRhdGEtaGlkZT1cIjFcIiBkYXRhLXJlbW92ZT1cIjFcIj7QldGJ0LUuLi48L3NwYW4+XG4vLyA8L2Rpdj4iLCJcInVzZSBzdHJpY3RcIjtcblxuZnVuY3Rpb24gX18oKSB7dHJ5IHtmb3IodmFyIGk9MDsgaTxhcmd1bWVudHMubGVuZ3RoOyBpKyspIHtjb25zb2xlLmxvZyhhcmd1bWVudHNbaV0pO319Y2F0Y2ggKGUpIHt9fVxuXG5mdW5jdGlvbiBzcHJpbnRmKHYpIHtcbiAgdmFyIHNwbGl0ID0gdi50b1N0cmluZygpLnNwbGl0KCcuJyksIHBhZCA9IFwiMDBcIiwgdGltZSA9IFtdLCB4ID0gbnVsbDtcblxuICBmb3IgKHggaW4gc3BsaXQpIHtcbiAgICB0aW1lLnB1c2gocGFkLnN1YnN0cmluZygwLCAyIC0gc3BsaXRbeF0udG9TdHJpbmcoKS5sZW5ndGgpICsgc3BsaXRbeF0pO1xuICB9XG5cbiAgcmV0dXJuIHRpbWUuam9pbignLicpO1xufSIsIiQoZG9jdW1lbnQpLnJlYWR5KGZ1bmN0aW9uKCkge1xuICAgIGFwcC5pbml0KCk7XG59KTsiXX0=
